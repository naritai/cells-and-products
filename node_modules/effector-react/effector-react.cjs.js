function t(t){var e,r;return r=e=class extends n.Component{constructor(){super(...arguments),this.state={currentState:t.getState()},this._unsubscribe=null,this._hasUnmounted=0}componentDidMount(){this.subscribe()}componentWillUnmount(){this.unsubscribe(),this._hasUnmounted=1}render(){return this.props.children(this.state.currentState)}subscribe(){const e=t.subscribe(t=>{this._hasUnmounted||this.setState(e=>t===e.currentState?null:{currentState:t})});this._unsubscribe=e}unsubscribe(){'function'==typeof this._unsubscribe&&this._unsubscribe(),this._unsubscribe=null}},e.displayName=`${t.shortName}.Consumer`,r}function e(){return(e=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t}).apply(this,arguments)}function r(r,s){const o=t(r),c=t=>n.createElement(o,null,r=>n.createElement(s,e({},t,r)));return c.displayName=`Connect(${s.displayName||s.name||'Unknown'})`,c}Object.defineProperty(exports,'__esModule',{value:1});var n=require('react'),effector=require('effector');const s=effector.createDomain('Gate').store;exports.createStoreConsumer=t,exports.unstable_createStoreProvider=function(t){var e,r;return r=e=class extends n.Component{constructor(){super(...arguments),this.state={currentValue:null}}static getDerivedStateFromProps(e){return t.setState(e.value),{currentValue:e.value}}render(){return this.props.children}},e.displayName=`${t.shortName}.Provider`,e.defaultProps={children:null},r},exports.createContextComponent=function(e,r,s){var o,c;const u=t(e);return c=o=class extends n.Component{constructor(){super(...arguments),this.renderProp=(t=>s(this.props,t,this.context))}render(){return n.createElement(u,null,this.renderProp)}},o.contextType=r,c},exports.createComponent=function(e,r){const s=t(e);return class extends n.Component{constructor(){super(...arguments),this.renderProp=(t=>r(this.props,t))}render(){return n.createElement(s,null,this.renderProp)}}},exports.useStore=function(t){const e=n.useState(t.getState),r=e[0],s=e[1];return n.useEffect(()=>t.watch(t=>s(()=>t)),[t]),r},exports.connect=function(t){return e=>r(e,t)},exports.createReactState=r,exports.createGate=function t(e,r){void 0===e&&(e='gate'),void 0===r&&(r={});const o=s(0),c=s(r),u=effector.createApi(c,{set:(t,e)=>e}).set,a=effector.createApi(o,{open:()=>d.predicate()&&1,close:()=>0,destructor:()=>0}),i=a.open,p=a.close,l=a.destructor;class d extends n.PureComponent{static childGate(r){void 0===r&&(r='Subgate');const n=t(`${e}/${r}`);n.predicate=(()=>d.status.getState());let s=0,o=0;return n.open.watch(()=>{o||(s=1)}),n.close.watch(()=>{o||(s=0)}),d.status.watch(t=>{o=1,s&&t&&!n.status.getState()&&n.open(),o=0}),d.close.watch(()=>{o=1,n.close(),o=0}),d.destructor.watch(()=>n.destructor()),n}componentDidMount(){d.open()}componentWillUnmount(){d.close()}render(){return d.set(this.props),null}}d.predicate=(()=>1),d.displayName=`Gate:${e}`,d.isOpen=0,d.current=c.getState(),d.open=i,d.close=p,d.status=o,d.state=c,d.set=u,d.destructor=l,d.isTerminated=0;const h=o.watch(t=>d.isOpen=t),m=c.watch(t=>d.current=t);o.map(t=>{t||(d.current=r)}),c.reset(p);const f=l.watch(()=>{d.isTerminated=1}),b=l.watch(()=>{b(),h(),m(),f(),(()=>{d.status.off(d.open),d.status.off(d.close),d.status.off(d.destructor)})(),d.state.off(d.set)});return d},exports.useGate=function(t,e){void 0===e&&(e={}),n.useEffect(()=>(t.open(),()=>t.close()),[t]),t.set(e)};
//# sourceMappingURL=effector-react.cjs.js.map
